import{d as W,u as K,f as H,b as z,e as Ve,O as C,aw as Be,x as ie,o as _,l as I,F as Z,P as Pe,B as l,D as v,C as e,m as u,q as j,Q as xe,M as m,b3 as Le,j as ce,U as q,b4 as de,b5 as ue,b6 as me,t as pe,v as J,h as L,i as Ee,k as ae,R as fe,n as ge,w as R,H as N,I as ve,S as _e,b7 as Oe,K as be,L as ye,N as Ae,at as Me,ab as X,E as re,b8 as le,b9 as Re,ba as Fe,bb as qe,am as Ge,aa as De,Z as je,$ as Ne}from"./buyer.bdd9e512.js";import{g as We,t as Ke,c as He,W as ze,a as Ye,B as Qe,b as Xe,s as Ze,m as Je,d as en,e as nn,p as on,o as sn,f as tn,j as an,u as we,V as rn,h as ln,_ as cn,i as dn,k as un,E as mn}from"./checkout.047f7221.js";const pn={class:"social-box"},fn={class:"social-info"},gn=["src","alt"],vn={class:"social-label"},_n=["onClick"],bn={key:1,class:"confirm-box"},yn=["onClick"],wn=W({__name:"social-bind",props:{isOnlyOneBind:{type:Boolean,default:()=>!1}},setup(U){const a=U,{t:w}=K(),o=H(),p=z(),g=Ve(),f={[C.google]:"bindGoogle",[C.twitter]:"bindTwitter"},T=Be([{label:"Google",img:We,key:f[C.google],openType:C.google},{label:"Twitter",img:Ke,key:f[C.twitter],openType:C.twitter}]);function k(){window.history.pushState({},"",window.location.origin+window.location.pathname)}function b(d){const t=window.location.origin+"/buyer/settings";xe({openType:d.openType,tenantId:o.tenantId,redirectUrl:t}).then(i=>{if(i.error.value){m({message:w("common.cannot-connect"),type:"error"});return}i.data.value&&(location.href=i.data.value)})}function h(){let d=g.query.code;const{state:t}=Le(g.query.state);if(d&&t){const i=window.location.origin+window.location.pathname;ce({authCode:d,openType:t,tenantId:o.tenantId,redirectUrl:i,userType:q.buyer}).then(r=>{if(r.error.value){m({message:r.error.value.msg||w("common.grant-failed"),type:"error"}),k();return}r.data.value&&de({openType:t,openId:r.data.value}).then(S=>{if(S.error.value){m({message:S.error.value.msg||w("common.grant-failed"),type:"error"}),k();return}m({message:w("common.bind-success"),type:"success"}),k(),p.changeUserInfo({...p.useInfo,[f[t]]:!0})})})}}function $(d){ue({message:`${w("common.sure-to-unbind")}?`,cancelText:w("common.cancel"),defineText:w("mall.confirm")}).then(()=>{me(d.openType).then(t=>{t.error.value||(m({message:w("common.unbind-success"),type:"success"}),p.changeUserInfo({...p.useInfo,[d.key]:!1}))})}).catch(()=>{})}return ie(()=>{h()}),(d,t)=>{const i=pe;return _(),I("div",null,[(_(!0),I(Z,null,Pe(e(T),r=>(_(),I("div",{class:"social-item",key:r.key},[l("div",pn,[l("div",fn,[l("img",{loading:"lazy",class:"social-image",src:r.img,alt:r.key},null,8,gn),l("div",vn,v(r.label),1)]),e(p).useInfo[r.key]?(_(),I("div",bn,[u(i,{class:"checkbox-icon",name:"checkbox"})])):(_(),I("section",{key:0,class:"go-unbind",onClick:S=>b(r)},v(d.$t("common.go-to-bind")),9,_n))]),e(p).useInfo[r.key]&&!a.isOnlyOneBind?(_(),I("div",{key:0,class:"unbind-label",onClick:S=>$(r)},v(d.$t("common.go-to-unbind")),9,yn)):j("",!0)]))),128))])}}});const In=J(wn,[["__scopeId","data-v-50728520"]]),hn={class:"about font-bold"},Te="8e6b5ffdcbc9794bf9f4a1952578365b",$n=W({__name:"wallet-bind",setup(U){const{t:a}=K(),w=z(),o=H(),p=L(""),g=L(""),f=[Je,en,nn,on,sn,tn],{publicClient:T}=He(f,[ze({projectId:Te})]),k=Ye({autoConnect:!0,connectors:Qe({projectId:Te,chains:f}),publicClient:T}),b=new an(k,f);return new Xe({projectId:Te,themeMode:"dark"},b),b.watchAccount(async h=>{var $;if(h.address&&(($=h.connector)!=null&&$.name)){p.value=h.connector.name,g.value=h.address;const{data:d}=await Ee({address:h.address,tenantId:o.tenantId,openType:C.wallet,userType:q.buyer});if(!d.value){m({message:a("common.cannot-connect"),type:"error"}),b.disconnect();return}const t=await Ze({message:d.value}),{data:i}=await ce({openType:C.wallet,sign:t,address:g.value,tenantId:o.tenantId,userType:q.buyer});if(!i.value){m({message:a("common.cannot-connect"),type:"error"}),b.disconnect();return}de({openType:C.wallet,openId:i.value}).then(r=>{if(r.error.value){m({message:a("common.grant-failed"),type:"error"}),b.disconnect();return}m({message:a("common.bind-success"),type:"success"}),w.initUserInfo("",!0),b.disconnect()})}}),(h,$)=>{const d=ae("w3m-connect-button"),t=ae("w3m-modal");return _(),I("div",hn,[u(d),u(t)])}}}),kn={class:"email-unbind-dialog"},Cn={class:"title"},Un={class:"email-wrap"},Tn={class:"code-wrapper form-item"},Sn=W({__name:"email-unbind",props:{visible:{type:Boolean,default:!1}},emits:["close"],setup(U,{emit:a}){const w=U,{t:o}=K(),p=H(),g=z(),{seconds:f,frequency:T,sendSuccess:k,sendCodeLoading:b}=we("emailUnbind"),{reset:h,params:$,errorTip:d,checkForm:t,checkAllForm:i,confirmLoading:r}=fe({formKeyArr:["code"],errorMap:{code:y=>y?"":o("common.empty")}}),S={[rn]:()=>{d.value.code=o("common.veri-code-error")},[ln]:()=>{d.value.code=o("common.veri-code-not")}};function E(){if(T.value>6){m({message:o("common.sent-reached")});return}b.value||f.value||(b.value=!0,ve({email:g.useInfo.email,eventType:_e.UnBindEmailSendVerifyCode,tenantId:p.tenantId,userType:q.buyer}).then(y=>{if(b.value=!1,y.error.value){S[y.error.value.code]();return}y.error.value||k()}))}function F(){r.value||i()||(r.value=!0,Oe({code:$.value.code,email:g.useInfo.email}).then(y=>{y.error.value||(m({type:"success",message:o("common.unbind-success")}),O(),g.initUserInfo("",!0)),r.value=!1}))}function O(){a("close")}return(y,V)=>{const A=be,P=ye,G=Ae;return _(),ge(G,{visible:w.visible,onClose:O},{default:R(()=>[l("div",kn,[l("div",Cn,v(y.$t("common.email-un-bind")),1),l("div",Un,[l("div",null,v(e(g).useInfo.email),1)]),l("div",Tn,[u(A,{class:"input-wrapper",onInputBlur:V[0]||(V[0]=M=>e(t)("code")),"error-tip":e(d).code,"onUpdate:errorTip":V[1]||(V[1]=M=>e(d).code=M),"input-value":e($).code,"onUpdate:inputValue":V[2]||(V[2]=M=>e($).code=M),placeholder:y.$t("mall.code"),"limit-length":6},null,8,["error-tip","input-value","placeholder"]),u(P,{"aria-label":y.$t("login-page.send-code"),class:"send-code",onClick:E,plain:!0,loading:e(b),disabled:e(T)>6},{default:R(()=>[N(v(e(f)?e(f)+" S":y.$t("login-page.send-code")),1)]),_:1},8,["aria-label","loading","disabled"])]),u(P,{"aria-label":"Unbind",loading:e(r),class:"unbind-button",onClick:F},{default:R(()=>[N(v(y.$t("common.un-bind")),1)]),_:1},8,["loading"])])]),_:1},8,["visible"])}}});const Vn=J(Sn,[["__scopeId","data-v-08d1a97d"]]),se=U=>(je("data-v-829bd103"),U=U(),Ne(),U),Bn={class:"settings-wrapper"},Pn=se(()=>l("div",{class:"settings-title"},"Preference setting",-1)),xn={class:"settings-content-wrapper"},Ln=se(()=>l("div",{class:"form-label first-form-label"},"Language",-1)),En=se(()=>l("div",{class:"form-label"},"Currency",-1)),On=se(()=>l("div",{class:"settings-title account-binding-information-title"},"Account binding information",-1)),An={class:"settings-content-wrapper"},Mn=se(()=>l("div",{class:"form-label first-form-label"},"WEB 3.0",-1)),Rn={class:"already-bind-wrap",key:"already-bind-wrap"},Fn={class:"already-bind-box"},qn={class:"confirm-box"},Gn={class:"form-label"},Dn={class:"form-label"},jn={class:"code-wrapper"},Nn={key:1,class:"already-bind-wrap email-already-bind"},Wn={class:"already-bind-box"},Kn={class:"confirm-box"},Hn=W({__name:"index",setup(U){const{t:a}=K(),w=H(),o=z(),p=Me(),g=L(""),f=L(""),T=X(()=>p.languageList),k=X(()=>p.currencyList);function b(){o.useInfo&&o.useInfo.languageId?g.value=o.useInfo.languageId:g.value=T.value[0].languageId,o.useInfo&&o.useInfo.currencyId?f.value=o.useInfo.currencyId:f.value=k.value[0].id}function h(){ue({message:`${a("common.sure-to-unbind")}?`,cancelText:a("common.cancel"),defineText:a("mall.confirm")}).then(()=>{me(C.wallet).then(s=>{s.error.value?m({message:s.error.value.msg,type:"error"}):(m({message:a("common.unbind-success"),type:"success"}),o.initUserInfo("",!0))})}).catch(()=>{})}function $(s,n){let B=o.useInfo.languageId;s!==B&&le({languageId:n.languageId}).then(x=>{x.error.value?m({message:x.error.value.msg,type:"error"}):(m({message:a("common.modifiable-success"),type:"success"}),n.index===-1?(o.useInfo.languageId=n.languageId,o.changeUserInfo(o.useInfo),p.removeLanguage(),Re(),location.reload()):(p.setLanguage(n),o.useInfo.languageId=n.languageId,o.changeUserInfo(o.useInfo),Fe(n.index)))})}function d(s,n){let B=p.currency.id;s!==B&&le({currencyId:n.id}).then(x=>{x.error.value?m({message:x.error.value.msg,type:"error"}):(o.useInfo.currencyId=n.id,o.changeUserInfo(o.useInfo),p.setCurrency(n),m({message:a("common.modifiable-success"),type:"success"}))})}ie(()=>{o.initUserInfo("",!0),b()});const{params:t,errorTip:i,checkForm:r,checkAllForm:S,confirmLoading:E}=fe({formKeyArr:["email","password","confirmPassword","code"],errorMap:{email:s=>{if(s){if(!dn.test(s))return a("common.email-format")}else return a("common.empty");return""},password:s=>{if(s){if(s.length<8)return a("common.characters-number",{msg:"8 - 16"});if(!un.test(s))return a("common.incorrect-format")}else return a("common.empty");return""},confirmPassword:s=>{if(s){if(s!==t.value.password)return a("common.inconsistent-password")}else return a("common.empty");return""},code:s=>s?"":a("common.empty")}}),F=X(()=>{let s=[o.useInfo.bindGoogle,o.useInfo.bindTwitter,o.useInfo.email,o.useInfo.walletAddress],n=0;return s.forEach(B=>{B&&n++}),n<=1}),{seconds:O,frequency:y,sendSuccess:V,sendCodeLoading:A}=we("buyer-settings"),P={email:100,password:16,confirmPassword:16,code:6},G={[mn]:()=>{i.value.email=a("common.email-registered")}};function M(){if(y.value>6){m({message:a("common.sent-reached")});return}A.value||O.value||(r("email"),i.value.email||(A.value=!0,ve({email:t.value.email,eventType:_e.bindEmailSendVerifyCode,tenantId:w.tenantId,userType:q.buyer}).then(s=>{A.value=!1,s.error.value||V()})))}function Ie(){E.value||S()||(E.value=!0,qe({code:t.value.code,email:t.value.email,password:t.value.password,confirmPassword:t.value.confirmPassword}).then(s=>{if(E.value=!1,s.error.value){G[s.error.value.code]?G[s.error.value.code]():m({message:a("common.bind-failed"),type:"error"});return}else m({message:a("common.bind-success"),type:"success"}),o.initUserInfo("",!0)}))}const Y=L(!1);function he(){Y.value=!1}const Q=L(!1);function $e(){Q.value=!1}const ee=L();function ke(){ee.value.setData(o.useInfo.email),Y.value=!0}function Ce(){Q.value=!0}return(s,n)=>{const B=Ge,x=De,ne=pe,D=be,oe=ye,Ue=cn;return _(),I("div",Bn,[Pn,l("div",xn,[Ln,u(B,{class:"form-select",hideCloseIcon:!0,modelValue:e(g),"onUpdate:modelValue":n[0]||(n[0]=c=>re(g)?g.value=c:null),"select-list":e(T),"label-attr":"value","value-attr":"languageId",onChange:$},null,8,["modelValue","select-list"]),En,u(B,{class:"form-select",hideCloseIcon:!0,modelValue:e(f),"onUpdate:modelValue":n[1]||(n[1]=c=>re(f)?f.value=c:null),"select-list":e(k),"label-attr":"code","value-attr":"id",onChange:d},null,8,["modelValue","select-list"])]),On,l("div",An,[Mn,l("div",Rn,[e(o).useInfo.walletAddress?(_(),I(Z,{key:1},[l("div",Fn,[l("div",null,v(e(o).useInfo.walletAddress),1),l("div",qn,[u(ne,{class:"checkbox-icon",name:"checkbox"})])]),e(F)?j("",!0):(_(),I("div",{key:0,class:"unbind-label",onClick:h},v(s.$t("common.go-to-unbind")),1))],64)):(_(),ge(x,{key:0},{default:R(()=>[u($n)]),_:1}))]),l("div",Gn,v(s.$t("buyer.social-platforms")),1),u(In,{isOnlyOneBind:e(F)},null,8,["isOnlyOneBind"]),l("div",Dn,v(s.$t("login-page.email")),1),e(o).useInfo.email?(_(),I("div",Nn,[l("div",Wn,[l("div",null,v(e(o).useInfo.email),1),l("div",Kn,[u(ne,{class:"checkbox-icon",name:"checkbox"})])]),e(o).useInfo.email&&!e(F)?(_(),I("div",{key:0,class:"unbind-label",onClick:Ce},v(s.$t("common.go-to-unbind")),1)):j("",!0)])):(_(),I(Z,{key:0},[u(D,{class:"form-input","input-value":e(t).email,"onUpdate:inputValue":n[2]||(n[2]=c=>e(t).email=c),"error-tip":e(i).email,"onUpdate:errorTip":n[3]||(n[3]=c=>e(i).email=c),placeholder:"Fill in your email account","limit-length":P.email,onInputBlur:n[4]||(n[4]=c=>e(r)("email"))},null,8,["input-value","error-tip","limit-length"]),u(D,{type:"password",class:"form-input","input-value":e(t).password,"onUpdate:inputValue":n[5]||(n[5]=c=>e(t).password=c),"error-tip":e(i).password,"onUpdate:errorTip":n[6]||(n[6]=c=>e(i).password=c),"limit-length":P.password,placeholder:"Set password",onInputBlur:n[7]||(n[7]=c=>e(r)("password"))},null,8,["input-value","error-tip","limit-length"]),u(D,{type:"password",class:"form-input","input-value":e(t).confirmPassword,"onUpdate:inputValue":n[8]||(n[8]=c=>e(t).confirmPassword=c),"limit-length":P.confirmPassword,"error-tip":e(i).confirmPassword,"onUpdate:errorTip":n[9]||(n[9]=c=>e(i).confirmPassword=c),placeholder:s.$t("login-page.confirm-password"),onInputBlur:n[10]||(n[10]=c=>e(r)("confirmPassword"))},null,8,["input-value","limit-length","error-tip","placeholder"]),l("div",jn,[u(D,{class:"code-input","limit-length":P.code,placeholder:s.$t("mall.code"),"input-value":e(t).code,"onUpdate:inputValue":n[11]||(n[11]=c=>e(t).code=c),"error-tip":e(i).code,"onUpdate:errorTip":n[12]||(n[12]=c=>e(i).code=c),onInputBlur:n[13]||(n[13]=c=>e(r)("code"))},null,8,["limit-length","placeholder","input-value","error-tip"]),u(oe,{"aria-label":s.$t("login-page.send-code"),class:"send-code",onClick:M,loading:e(A),plain:!0},{default:R(()=>[N(v(e(O)?e(O)+" S":s.$t("login-page.send-code")),1)]),_:1},8,["aria-label","loading"])]),u(oe,{loading:e(E),class:"binding-button",onClick:Ie},{default:R(()=>[N(v(s.$t("common.go-to-bind")),1)]),_:1},8,["loading"])],64)),e(o).useInfo.email?(_(),I("div",{key:2,class:"reset-password",onClick:ke},v(s.$t("login-page.reset-password")),1)):j("",!0)]),u(Ue,{visible:e(Y),ref_key:"resetPassSettings",ref:ee,"default-email-value":e(o).useInfo.email,disabled:!0,onClose:he},null,8,["visible","default-email-value"]),u(Vn,{visible:e(Q),onClose:$e},null,8,["visible"])])}}});const xo=J(Hn,[["__scopeId","data-v-829bd103"]]),zn={class:"social-box"},Yn={class:"social-info"},Qn=["src","alt"],Xn={class:"social-label"},Zn=["onClick"],Jn={key:1,class:"confirm-box"},eo=["onClick"],no=W({__name:"social-bind",props:{isOnlyOneBind:{type:Boolean,default:()=>!1}},setup(U){const a=U,{t:w}=K(),o=H(),p=z(),g=Ve(),f={[C.google]:"bindGoogle",[C.twitter]:"bindTwitter"},T=Be([{label:"Google",img:We,key:f[C.google],openType:C.google},{label:"Twitter",img:Ke,key:f[C.twitter],openType:C.twitter}]);function k(){window.history.pushState({},"",window.location.origin+window.location.pathname)}function b(d){const t=window.location.origin+"/buyer/settings";xe({openType:d.openType,tenantId:o.tenantId,redirectUrl:t}).then(i=>{if(i.error.value){m({message:w("common.cannot-connect"),type:"error"});return}i.data.value&&(location.href=i.data.value)})}function h(){let d=g.query.code;const{state:t}=Le(g.query.state);if(d&&t){const i=window.location.origin+window.location.pathname;ce({authCode:d,openType:t,tenantId:o.tenantId,redirectUrl:i,userType:q.buyer}).then(r=>{if(r.error.value){m({message:r.error.value.msg||w("common.grant-failed"),type:"error"}),k();return}r.data.value&&de({openType:t,openId:r.data.value}).then(S=>{if(S.error.value){m({message:S.error.value.msg||w("common.grant-failed"),type:"error"}),k();return}m({message:w("common.bind-success"),type:"success"}),k(),p.changeUserInfo({...p.useInfo,[f[t]]:!0})})})}}function $(d){ue({message:`${w("common.sure-to-unbind")}?`,cancelText:w("common.cancel"),defineText:w("mall.confirm")}).then(()=>{me(d.openType).then(t=>{t.error.value||(m({message:w("common.unbind-success"),type:"success"}),p.changeUserInfo({...p.useInfo,[d.key]:!1}))})}).catch(()=>{})}return ie(()=>{h()}),(d,t)=>{const i=pe;return _(),I("div",null,[(_(!0),I(Z,null,Pe(e(T),r=>(_(),I("div",{class:"social-item",key:r.key},[l("div",zn,[l("div",Yn,[l("img",{loading:"lazy",class:"social-image",src:r.img,alt:r.key},null,8,Qn),l("div",Xn,v(r.label),1)]),e(p).useInfo[r.key]?(_(),I("div",Jn,[u(i,{class:"checkbox-icon",name:"checkbox"})])):(_(),I("section",{key:0,class:"go-unbind",onClick:S=>b(r)},v(d.$t("common.go-to-bind")),9,Zn))]),e(p).useInfo[r.key]&&!a.isOnlyOneBind?(_(),I("div",{key:0,class:"unbind-label",onClick:S=>$(r)},v(d.$t("common.go-to-unbind")),9,eo)):j("",!0)]))),128))])}}});const oo=J(no,[["__scopeId","data-v-d7f7f063"]]),so={class:"about font-bold"},Se="8e6b5ffdcbc9794bf9f4a1952578365b",to=W({__name:"wallet-bind",setup(U){const{t:a}=K(),w=z(),o=H(),p=L(""),g=L(""),f=[Je,en,nn,on,sn,tn],{publicClient:T}=He(f,[ze({projectId:Se})]),k=Ye({autoConnect:!0,connectors:Qe({projectId:Se,chains:f}),publicClient:T}),b=new an(k,f);return new Xe({projectId:Se,themeMode:"dark"},b),b.watchAccount(async h=>{var $;if(h.address&&(($=h.connector)!=null&&$.name)){p.value=h.connector.name,g.value=h.address;const{data:d}=await Ee({address:h.address,tenantId:o.tenantId,openType:C.wallet,userType:q.buyer});if(!d.value){m({message:a("common.cannot-connect"),type:"error"}),b.disconnect();return}const t=await Ze({message:d.value}),{data:i}=await ce({openType:C.wallet,sign:t,address:g.value,tenantId:o.tenantId,userType:q.buyer});if(!i.value){m({message:a("common.cannot-connect"),type:"error"}),b.disconnect();return}de({openType:C.wallet,openId:i.value}).then(r=>{if(r.error.value){m({message:a("common.grant-failed"),type:"error"}),b.disconnect();return}m({message:a("common.bind-success"),type:"success"}),w.initUserInfo("",!0),b.disconnect()})}}),(h,$)=>{const d=ae("w3m-connect-button"),t=ae("w3m-modal");return _(),I("div",so,[u(d),u(t)])}}}),ao={class:"email-unbind-dialog"},ro={class:"title"},lo={class:"email-wrap"},io={class:"code-wrapper form-item"},co=W({__name:"email-unbind",props:{visible:{type:Boolean,default:!1}},emits:["close"],setup(U,{emit:a}){const w=U,{t:o}=K(),p=H(),g=z(),{seconds:f,frequency:T,sendSuccess:k,sendCodeLoading:b}=we("emailUnbind"),{reset:h,params:$,errorTip:d,checkForm:t,checkAllForm:i,confirmLoading:r}=fe({formKeyArr:["code"],errorMap:{code:y=>y?"":o("common.empty")}}),S={[rn]:()=>{d.value.code=o("common.veri-code-error")},[ln]:()=>{d.value.code=o("common.veri-code-not")}};function E(){if(T.value>6){m({message:o("common.sent-reached")});return}b.value||f.value||(b.value=!0,ve({email:g.useInfo.email,eventType:_e.UnBindEmailSendVerifyCode,tenantId:p.tenantId,userType:q.buyer}).then(y=>{if(b.value=!1,y.error.value){S[y.error.value.code]();return}y.error.value||k()}))}function F(){r.value||i()||(r.value=!0,Oe({code:$.value.code,email:g.useInfo.email}).then(y=>{y.error.value||(m({type:"success",message:o("common.unbind-success")}),O(),g.initUserInfo("",!0)),r.value=!1}))}function O(){a("close")}return(y,V)=>{const A=be,P=ye,G=Ae;return _(),ge(G,{visible:w.visible,onClose:O},{default:R(()=>[l("div",ao,[l("div",ro,v(y.$t("common.email-un-bind")),1),l("div",lo,[l("div",null,v(e(g).useInfo.email),1)]),l("div",io,[u(A,{class:"input-wrapper",onInputBlur:V[0]||(V[0]=M=>e(t)("code")),"error-tip":e(d).code,"onUpdate:errorTip":V[1]||(V[1]=M=>e(d).code=M),"input-value":e($).code,"onUpdate:inputValue":V[2]||(V[2]=M=>e($).code=M),placeholder:y.$t("mall.code"),"limit-length":6},null,8,["error-tip","input-value","placeholder"]),u(P,{"aria-label":y.$t("login-page.send-code"),class:"send-code",onClick:E,plain:!0,loading:e(b),disabled:e(T)>6},{default:R(()=>[N(v(e(f)?e(f)+" S":y.$t("login-page.send-code")),1)]),_:1},8,["aria-label","loading","disabled"])]),u(P,{"aria-label":"Unbind",loading:e(r),class:"unbind-button",onClick:F},{default:R(()=>[N(v(y.$t("common.un-bind")),1)]),_:1},8,["loading"])])]),_:1},8,["visible"])}}});const uo=J(co,[["__scopeId","data-v-f10dd370"]]),te=U=>(je("data-v-f77af903"),U=U(),Ne(),U),mo={class:"settings-wrapper"},po=te(()=>l("div",{class:"settings-title"},"Preference setting",-1)),fo={class:"settings-content-wrapper"},go=te(()=>l("div",{class:"form-label first-form-label"},"Language",-1)),vo=te(()=>l("div",{class:"form-label"},"Currency",-1)),_o=te(()=>l("div",{class:"settings-title account-binding-information-title"},"Account binding information",-1)),bo={class:"settings-content-wrapper"},yo=te(()=>l("div",{class:"form-label first-form-label"},"WEB 3.0",-1)),wo={class:"already-bind-wrap",key:"already-bind-wrap"},Io={class:"already-bind-box"},ho={class:"confirm-box"},$o={class:"form-label"},ko={class:"form-label"},Co={class:"code-wrapper"},Uo={key:1,class:"already-bind-wrap email-already-bind"},To={class:"already-bind-box"},So={class:"confirm-box"},Vo=W({__name:"index",setup(U){const{t:a}=K(),w=H(),o=z(),p=Me(),g=L(""),f=L(""),T=X(()=>p.languageList),k=X(()=>p.currencyList);function b(){o.useInfo&&o.useInfo.languageId?g.value=o.useInfo.languageId:g.value=T.value[0].languageId,o.useInfo&&o.useInfo.currencyId?f.value=o.useInfo.currencyId:f.value=k.value[0].id}function h(){ue({message:`${a("common.sure-to-unbind")}?`,cancelText:a("common.cancel"),defineText:a("mall.confirm")}).then(()=>{me(C.wallet).then(s=>{s.error.value?m({message:s.error.value.msg,type:"error"}):(m({message:a("common.unbind-success"),type:"success"}),o.initUserInfo("",!0))})}).catch(()=>{})}function $(s,n){let B=o.useInfo.languageId;s!==B&&le({languageId:n.languageId}).then(x=>{x.error.value?m({message:x.error.value.msg,type:"error"}):(m({message:a("common.modifiable-success"),type:"success"}),n.index===-1?(p.removeLanguage(),Re(),location.reload()):(p.setLanguage(n),Fe(n.index)))})}function d(s,n){let B=p.currency.id;s!==B&&le({currencyId:n.id}).then(x=>{x.error.value?m({message:x.error.value.msg,type:"error"}):(p.setCurrency(n),m({message:a("common.modifiable-success"),type:"success"}))})}ie(()=>{o.initUserInfo("",!0),b()});const{params:t,errorTip:i,checkForm:r,checkAllForm:S,confirmLoading:E}=fe({formKeyArr:["email","password","confirmPassword","code"],errorMap:{email:s=>{if(s){if(!dn.test(s))return a("common.email-format")}else return a("common.empty");return""},password:s=>{if(s){if(s.length<8)return a("common.characters-number",{msg:"8 - 16"});if(!un.test(s))return a("common.incorrect-format")}else return a("common.empty");return""},confirmPassword:s=>{if(s){if(s!==t.value.password)return a("common.inconsistent-password")}else return a("common.empty");return""},code:s=>s?"":a("common.empty")}}),F=X(()=>{let s=[o.useInfo.bindGoogle,o.useInfo.bindTwitter,o.useInfo.email,o.useInfo.walletAddress],n=0;return s.forEach(B=>{B&&n++}),n<=1}),{seconds:O,frequency:y,sendSuccess:V,sendCodeLoading:A}=we("buyer-settings"),P={email:100,password:16,confirmPassword:16,code:6},G={[mn]:()=>{i.value.email=a("common.email-registered")}};function M(){if(y.value>6){m({message:a("common.sent-reached")});return}A.value||O.value||(r("email"),i.value.email||(A.value=!0,ve({email:t.value.email,eventType:_e.bindEmailSendVerifyCode,tenantId:w.tenantId,userType:q.buyer}).then(s=>{A.value=!1,s.error.value||V()})))}function Ie(){E.value||S()||(E.value=!0,qe({code:t.value.code,email:t.value.email,password:t.value.password,confirmPassword:t.value.confirmPassword}).then(s=>{if(E.value=!1,s.error.value){G[s.error.value.code]?G[s.error.value.code]():m({message:a("common.bind-failed"),type:"error"});return}else m({message:a("common.bind-success"),type:"success"}),o.initUserInfo("",!0)}))}const Y=L(!1);function he(){Y.value=!1}const Q=L(!1);function $e(){Q.value=!1}const ee=L();function ke(){ee.value.setData(o.useInfo.email),Y.value=!0}function Ce(){Q.value=!0}return(s,n)=>{const B=Ge,x=De,ne=pe,D=be,oe=ye,Ue=cn;return _(),I("div",mo,[po,l("div",fo,[go,u(B,{class:"form-select",hideCloseIcon:!0,modelValue:e(g),"onUpdate:modelValue":n[0]||(n[0]=c=>re(g)?g.value=c:null),"select-list":e(T),"label-attr":"value","value-attr":"languageId",onChange:$},null,8,["modelValue","select-list"]),vo,u(B,{class:"form-select",hideCloseIcon:!0,modelValue:e(f),"onUpdate:modelValue":n[1]||(n[1]=c=>re(f)?f.value=c:null),"select-list":e(k),"label-attr":"code","value-attr":"id",onChange:d},null,8,["modelValue","select-list"])]),_o,l("div",bo,[yo,l("div",wo,[e(o).useInfo.walletAddress?(_(),I(Z,{key:1},[l("div",Io,[l("div",null,v(e(o).useInfo.walletAddress),1),l("div",ho,[u(ne,{class:"checkbox-icon",name:"checkbox"})])]),e(F)?j("",!0):(_(),I("div",{key:0,class:"unbind-label",onClick:h},v(s.$t("common.go-to-unbind")),1))],64)):(_(),ge(x,{key:0},{default:R(()=>[u(to)]),_:1}))]),l("div",$o,v(s.$t("buyer.social-platforms")),1),u(oo,{isOnlyOneBind:e(F)},null,8,["isOnlyOneBind"]),l("div",ko,v(s.$t("login-page.email")),1),e(o).useInfo.email?(_(),I("div",Uo,[l("div",To,[l("div",null,v(e(o).useInfo.email),1),l("div",So,[u(ne,{class:"checkbox-icon",name:"checkbox"})])]),e(o).useInfo.email&&!e(F)?(_(),I("div",{key:0,class:"unbind-label",onClick:Ce},v(s.$t("common.go-to-unbind")),1)):j("",!0)])):(_(),I(Z,{key:0},[u(D,{class:"form-input","input-value":e(t).email,"onUpdate:inputValue":n[2]||(n[2]=c=>e(t).email=c),"error-tip":e(i).email,"onUpdate:errorTip":n[3]||(n[3]=c=>e(i).email=c),placeholder:"Fill in your email account","limit-length":P.email,onInputBlur:n[4]||(n[4]=c=>e(r)("email"))},null,8,["input-value","error-tip","limit-length"]),u(D,{type:"password",class:"form-input","input-value":e(t).password,"onUpdate:inputValue":n[5]||(n[5]=c=>e(t).password=c),"error-tip":e(i).password,"onUpdate:errorTip":n[6]||(n[6]=c=>e(i).password=c),"limit-length":P.password,placeholder:"Set password",onInputBlur:n[7]||(n[7]=c=>e(r)("password"))},null,8,["input-value","error-tip","limit-length"]),u(D,{type:"password",class:"form-input","input-value":e(t).confirmPassword,"onUpdate:inputValue":n[8]||(n[8]=c=>e(t).confirmPassword=c),"limit-length":P.confirmPassword,"error-tip":e(i).confirmPassword,"onUpdate:errorTip":n[9]||(n[9]=c=>e(i).confirmPassword=c),placeholder:s.$t("login-page.confirm-password"),onInputBlur:n[10]||(n[10]=c=>e(r)("confirmPassword"))},null,8,["input-value","limit-length","error-tip","placeholder"]),l("div",Co,[u(D,{class:"code-input","limit-length":P.code,placeholder:s.$t("mall.code"),"input-value":e(t).code,"onUpdate:inputValue":n[11]||(n[11]=c=>e(t).code=c),"error-tip":e(i).code,"onUpdate:errorTip":n[12]||(n[12]=c=>e(i).code=c),onInputBlur:n[13]||(n[13]=c=>e(r)("code"))},null,8,["limit-length","placeholder","input-value","error-tip"]),u(oe,{"aria-label":s.$t("login-page.send-code"),class:"send-code",onClick:M,loading:e(A),plain:!0},{default:R(()=>[N(v(e(O)?e(O)+" S":s.$t("login-page.send-code")),1)]),_:1},8,["aria-label","loading"])]),u(oe,{loading:e(E),class:"binding-button",onClick:Ie},{default:R(()=>[N(v(s.$t("common.go-to-bind")),1)]),_:1},8,["loading"])],64)),e(o).useInfo.email?(_(),I("div",{key:2,class:"reset-password",onClick:ke},v(s.$t("login-page.reset-password")),1)):j("",!0)]),u(Ue,{visible:e(Y),ref_key:"resetPassSettings",ref:ee,disabled:!0,onClose:he},null,8,["visible"]),u(uo,{visible:e(Q),onClose:$e},null,8,["visible"])])}}});const Lo=J(Vo,[["__scopeId","data-v-f77af903"]]);export{xo as a,Lo as b};
